import type { Scenario } from '../types';

export const scenarios: Scenario[] = [
  // ========== TROUBLESHOOTING (12 scenarios) ==========
  {
    id: 'ts-001',
    category: 'troubleshooting',
    title: 'Shared Mailbox Access Failure',
    situation: 'A user reports they can no longer access a shared mailbox in Outlook. It was working yesterday. Other users can still access the same shared mailbox without issues. The affected user\'s personal mailbox works fine. They\'re on Windows 11 running the new Outlook client. No recent password changes.',
    roleHint: 'Consider what systematic diagnostic steps would help isolate the issue.',
    difficulty: 2,
    idealElements: ['role context', 'environment specifics included', 'asks for structured diagnostic steps', 'mentions what has been tried', 'scopes the issue clearly'],
  },
  {
    id: 'ts-002',
    category: 'troubleshooting',
    title: 'VPN Connection Dropping',
    situation: 'A remote employee reports their GlobalProtect VPN connection drops every 15-20 minutes. They have to manually reconnect each time. This started after they got a new home router last week. Other remote employees are not experiencing this issue. They\'re on a company-managed MacBook running macOS Sonoma.',
    roleHint: 'Think about both client-side and network-side factors.',
    difficulty: 2,
    idealElements: ['systematic approach', 'considers network factors', 'asks about router settings', 'mentions timing correlation', 'requests specific logs'],
  },
  {
    id: 'ts-003',
    category: 'troubleshooting',
    title: 'Printer Not Appearing',
    situation: 'A user on a new Windows 11 laptop cannot see any network printers. Other users in the same office can print normally. The laptop is domain-joined and on the corporate network. The user can access shared drives and other network resources without issues.',
    difficulty: 1,
    idealElements: ['checks print spooler', 'verifies driver status', 'considers group policy', 'methodical approach'],
  },
  {
    id: 'ts-004',
    category: 'troubleshooting',
    title: 'Teams Calls No Audio',
    situation: 'During Microsoft Teams calls, a user can see video but has no audio in either direction - they can\'t hear others and others can\'t hear them. Chat and screen sharing work fine. They\'re using a USB headset that works correctly in other applications. This happens on both scheduled meetings and ad-hoc calls.',
    roleHint: 'Audio issues often involve multiple layers of settings.',
    difficulty: 2,
    idealElements: ['checks Teams audio settings', 'verifies device permissions', 'tests with different devices', 'systematic isolation'],
  },
  {
    id: 'ts-005',
    category: 'troubleshooting',
    title: 'Outlook Search Not Working',
    situation: 'A user reports that Outlook search returns no results for emails they know exist. They can manually browse to folders and find the emails. This affects both the search bar and the instant search in folders. They have a large mailbox (50GB+) and use Outlook on Windows with a cached Exchange mode.',
    difficulty: 1,
    idealElements: ['considers indexing status', 'checks mailbox size impact', 'rebuilds search index', 'verifies cache settings'],
  },
  {
    id: 'ts-006',
    category: 'troubleshooting',
    title: 'OneDrive Sync Stuck',
    situation: 'A user\'s OneDrive shows "Sync Pending" for several files but hasn\'t made progress in two days. The OneDrive icon shows a blue sync arrow that never completes. They have 200GB of data in OneDrive. Restarting OneDrive and the computer haven\'t helped. Internet speed tests show normal connectivity.',
    roleHint: 'Sync issues can be caused by specific files or broader configuration problems.',
    difficulty: 2,
    idealElements: ['identifies stuck files', 'checks for file conflicts', 'considers file name/path issues', 'examines sync logs'],
  },
  {
    id: 'ts-007',
    category: 'troubleshooting',
    title: 'MFA Prompt Loop',
    situation: 'A user keeps getting prompted for MFA every time they open any Microsoft 365 application, even though they complete the verification successfully. This happens multiple times per hour. They\'re using the Microsoft Authenticator app. Other users on similar devices are only prompted once per day.',
    difficulty: 2,
    idealElements: ['examines token persistence', 'checks conditional access', 'verifies device registration', 'considers browser/app settings'],
  },
  {
    id: 'ts-008',
    category: 'troubleshooting',
    title: 'Slow Login Times',
    situation: 'Users at a specific office location report that logging into their Windows computers takes 5+ minutes. The login process appears to hang at "Welcome" for a long time. This affects all users at this location but no other offices. Network connectivity tests show normal speeds.',
    roleHint: 'Location-specific issues often point to infrastructure factors.',
    difficulty: 3,
    idealElements: ['considers group policy processing', 'checks DNS resolution', 'examines domain controller connectivity', 'reviews login scripts'],
  },
  {
    id: 'ts-009',
    category: 'troubleshooting',
    title: 'Calendar Invites Not Received',
    situation: 'A user reports they\'re not receiving calendar invites from external contacts. Internal invites work fine. The senders confirm the invites are being sent and don\'t receive bounce-backs. Checking the user\'s junk folder shows nothing. The user is on Microsoft 365 with Exchange Online.',
    difficulty: 2,
    idealElements: ['checks mail flow rules', 'examines transport rules', 'verifies inbox rules', 'considers external sharing settings'],
  },
  {
    id: 'ts-010',
    category: 'troubleshooting',
    title: 'Application Crash on Launch',
    situation: 'A line-of-business application crashes immediately after launch on one user\'s computer. The same application works for other users. The application was working fine until the user\'s laptop received Windows updates over the weekend. Event Viewer shows an application error with a faulting module name.',
    difficulty: 1,
    idealElements: ['examines event logs', 'checks application dependencies', 'considers recent changes', 'tests compatibility settings'],
  },
  {
    id: 'ts-011',
    category: 'troubleshooting',
    title: 'Email Attachment Size Limit',
    situation: 'A user needs to send a 35MB attachment but receives an error that the file is too large. They\'ve successfully sent large files before. The recipient is at an external organization. The user is on Microsoft 365 and can send smaller attachments without issues.',
    roleHint: 'Message size limits can exist at multiple points in the mail flow.',
    difficulty: 1,
    idealElements: ['explains size limits', 'suggests alternatives', 'considers recipient limits', 'mentions OneDrive sharing'],
  },
  {
    id: 'ts-012',
    category: 'troubleshooting',
    title: 'Intune Device Compliance Failure',
    situation: 'A user\'s corporate phone suddenly shows as non-compliant in Intune and they\'re being blocked from accessing company email. The compliance dashboard shows "BitLocker not enabled" but this is an iPhone, which doesn\'t use BitLocker. The device was compliant until this morning.',
    roleHint: 'Compliance policy targeting can sometimes cause unexpected results.',
    difficulty: 3,
    idealElements: ['examines policy assignment', 'checks device group membership', 'reviews compliance policy scope', 'considers recent policy changes'],
  },

  // ========== CLIENT COMMUNICATION (12 scenarios) ==========
  {
    id: 'cc-001',
    category: 'client-communication',
    title: 'Scheduled Maintenance Notification',
    situation: 'You need to notify end users at a client site that their email system will be unavailable for up to 30 minutes this Saturday between 2:00 AM and 4:00 AM for scheduled maintenance. No action is required from them. This client has non-technical users who tend to worry about changes.',
    roleHint: 'Consider the audience\'s technical level and emotional response to IT changes.',
    difficulty: 1,
    idealElements: ['specifies audience (non-technical)', 'tone (reassuring)', 'key details to include', 'what to omit', 'format'],
  },
  {
    id: 'cc-002',
    category: 'client-communication',
    title: 'Security Incident Summary',
    situation: 'A user at a client company clicked a phishing link and entered their credentials. You\'ve already reset their password and revoked sessions. Now you need to send a summary email to the client\'s IT manager explaining what happened, what you did, and what the user should do going forward.',
    roleHint: 'Balance transparency with appropriate reassurance.',
    difficulty: 2,
    idealElements: ['factual but not alarming', 'clear timeline', 'actions taken', 'next steps', 'professional tone'],
  },
  {
    id: 'cc-003',
    category: 'client-communication',
    title: 'Service Outage Update',
    situation: 'A client\'s critical line-of-business application has been down for 2 hours. You\'re working with the vendor but don\'t have an ETA yet. The client\'s CEO has been asking for updates every 30 minutes. You need to send a status update that acknowledges the impact without making promises you can\'t keep.',
    difficulty: 2,
    idealElements: ['empathetic acknowledgment', 'current status', 'what is being done', 'when next update will come', 'avoids false promises'],
  },
  {
    id: 'cc-004',
    category: 'client-communication',
    title: 'New Employee Onboarding Email',
    situation: 'A new employee is starting at a client company on Monday. You need to send them a welcome email with instructions for setting up their accounts, accessing email, and connecting to VPN for the first time. They\'re non-technical (marketing role) and this is their first job at a company using Microsoft 365.',
    difficulty: 1,
    idealElements: ['welcoming tone', 'step-by-step format', 'avoids jargon', 'includes support contact', 'clear next steps'],
  },
  {
    id: 'cc-005',
    category: 'client-communication',
    title: 'License Cost Increase Explanation',
    situation: 'Microsoft is increasing the price of Microsoft 365 Business Premium licenses by 15% next month. You need to notify affected clients before their next invoice. The client you\'re emailing is cost-conscious and has previously complained about IT expenses.',
    roleHint: 'Price increases require careful framing.',
    difficulty: 2,
    idealElements: ['empathetic to cost concerns', 'explains the value', 'notes what\'s included', 'offers to discuss alternatives', 'professional tone'],
  },
  {
    id: 'cc-006',
    category: 'client-communication',
    title: 'Password Policy Change Announcement',
    situation: 'A client company is implementing a new password policy requiring 14-character passwords with complexity requirements, plus mandatory password changes every 90 days. This is being driven by their cyber insurance requirements. You need to communicate this to all employees before it takes effect next week.',
    difficulty: 2,
    idealElements: ['explains the why', 'clear requirements', 'when it takes effect', 'how to comply', 'support resources'],
  },
  {
    id: 'cc-007',
    category: 'client-communication',
    title: 'Project Completion Summary',
    situation: 'You\'ve just completed a month-long Microsoft 365 migration for a client, moving them from Google Workspace. The project is complete and you need to send a wrap-up email to the client stakeholder summarizing what was accomplished, any outstanding items, and next steps for ongoing support.',
    difficulty: 2,
    idealElements: ['accomplishments listed', 'any caveats or follow-ups', 'transition to support', 'thanks the client', 'professional close'],
  },
  {
    id: 'cc-008',
    category: 'client-communication',
    title: 'Urgent Security Alert',
    situation: 'A critical zero-day vulnerability has been announced affecting a software product that several clients use. A patch is available but requires immediate installation and a system restart. You need to send an urgent communication to affected clients explaining the situation and requesting approval to proceed.',
    roleHint: 'Urgency must be conveyed without causing panic.',
    difficulty: 3,
    idealElements: ['conveys urgency appropriately', 'explains risk clearly', 'states required action', 'provides timeline', 'requests approval'],
  },
  {
    id: 'cc-009',
    category: 'client-communication',
    title: 'Declined Request Response',
    situation: 'A user at a client company has requested admin access to their company\'s Microsoft 365 tenant so they can "manage things themselves." The client\'s IT policy doesn\'t allow this, and the request needs to be declined. You need to respond to the user professionally while maintaining the relationship.',
    difficulty: 2,
    idealElements: ['respectful decline', 'explains the policy reason', 'offers alternatives', 'maintains relationship', 'appropriate tone'],
  },
  {
    id: 'cc-010',
    category: 'client-communication',
    title: 'Quarterly Review Summary',
    situation: 'You need to prepare a quarterly review email for a client summarizing the support tickets, projects completed, and recommendations for the next quarter. They had 47 tickets (down from 62 last quarter), completed a server migration, and you want to recommend upgrading their backup solution.',
    difficulty: 1,
    idealElements: ['structured format', 'highlights improvements', 'data-driven', 'actionable recommendations', 'professional tone'],
  },
  {
    id: 'cc-011',
    category: 'client-communication',
    title: 'After-Hours Work Approval',
    situation: 'A client needs critical server maintenance that requires 4 hours of downtime. This can only be done outside business hours. You need to send an email proposing the maintenance window, explaining why after-hours work is necessary, and getting approval for the associated after-hours billing.',
    difficulty: 2,
    idealElements: ['clear proposal', 'justifies after-hours need', 'states cost implications', 'proposes specific time', 'requests explicit approval'],
  },
  {
    id: 'cc-012',
    category: 'client-communication',
    title: 'Data Breach Notification Draft',
    situation: 'A client discovered that an employee accidentally shared a folder containing customer PII with external parties for 3 days before it was caught. The client needs to notify affected customers. They\'ve asked you to help draft the notification letter that will go out under their letterhead.',
    roleHint: 'Data breach notifications have legal implications and require careful wording.',
    difficulty: 3,
    idealElements: ['factual account', 'what data was exposed', 'steps taken', 'what recipients should do', 'appropriate tone', 'contact information'],
  },

  // ========== DOCUMENTATION (12 scenarios) ==========
  {
    id: 'doc-001',
    category: 'documentation',
    title: 'VPN System Extension Fix',
    situation: 'You just resolved a ticket where a macOS user couldn\'t connect to GlobalProtect VPN because macOS blocked the system extension. The fix was approving the extension in System Settings > Privacy & Security, then restarting the VPN client. Root cause was a missing PPPC profile in the MDM configuration.',
    roleHint: 'Good KB articles include symptoms, resolution, and prevention.',
    difficulty: 2,
    idealElements: ['specifies document type', 'audience (internal technical team)', 'includes root cause', 'prevention steps', 'verification steps'],
  },
  {
    id: 'doc-002',
    category: 'documentation',
    title: 'New User Onboarding Checklist',
    situation: 'Your team needs a standardized checklist for onboarding new employees at client companies. The process involves creating accounts in Microsoft 365, assigning licenses, adding to security groups, setting up email signatures, and configuring MFA. Different clients have different requirements.',
    difficulty: 2,
    idealElements: ['structured checklist format', 'customizable sections', 'verification steps', 'common variations noted'],
  },
  {
    id: 'doc-003',
    category: 'documentation',
    title: 'Conditional Access Policy Documentation',
    situation: 'You\'ve configured 5 conditional access policies for a client: require MFA for all users, block legacy authentication, require compliant devices for sensitive apps, location-based restrictions, and sign-in risk policies. You need to document these for the client\'s IT manager.',
    difficulty: 3,
    idealElements: ['policy names and purposes', 'what each policy does', 'who it affects', 'exceptions', 'testing notes'],
  },
  {
    id: 'doc-004',
    category: 'documentation',
    title: 'Incident Postmortem',
    situation: 'Last week, a client experienced a 4-hour email outage due to a misconfigured mail flow rule that was quarantining all inbound email. The root cause was a change made during a security review. You need to write a postmortem document for internal use.',
    roleHint: 'Postmortems should be blameless and focused on systemic improvements.',
    difficulty: 2,
    idealElements: ['timeline of events', 'root cause', 'impact assessment', 'what went well', 'what could improve', 'action items'],
  },
  {
    id: 'doc-005',
    category: 'documentation',
    title: 'Backup Recovery Runbook',
    situation: 'Your team uses Veeam to back up client servers. You need to create a step-by-step runbook for restoring a full server from backup, including how to access the backup console, select the restore point, and verify the restoration. This will be used by on-call technicians.',
    difficulty: 2,
    idealElements: ['step-by-step format', 'includes prerequisites', 'verification steps', 'common issues section', 'emergency contacts'],
  },
  {
    id: 'doc-006',
    category: 'documentation',
    title: 'Client Network Diagram Update',
    situation: 'A client just added a new branch office with its own firewall, switch, and 15 workstations connected via site-to-site VPN to headquarters. You need to update their network documentation to reflect this addition, including IP addressing and key device information.',
    difficulty: 1,
    idealElements: ['diagram description', 'IP addressing scheme', 'device inventory', 'connection details', 'update notes'],
  },
  {
    id: 'doc-007',
    category: 'documentation',
    title: 'Software Installation SOP',
    situation: 'Your team frequently installs a specific line-of-business application (an accounting software) at client sites. The installation has several gotchas: specific .NET version required, SQL Server configuration, firewall exceptions, and license activation. You need to create an SOP.',
    roleHint: 'SOPs should be detailed enough for any technician to follow.',
    difficulty: 2,
    idealElements: ['prerequisites listed', 'step-by-step instructions', 'configuration details', 'troubleshooting tips', 'verification steps'],
  },
  {
    id: 'doc-008',
    category: 'documentation',
    title: 'Security Audit Findings Report',
    situation: 'You completed a security audit for a client and found: 15 accounts with no MFA, 3 admin accounts being used for daily work, legacy authentication still enabled, and no conditional access policies. You need to create a findings report with recommendations prioritized by risk.',
    difficulty: 3,
    idealElements: ['executive summary', 'findings categorized by severity', 'specific recommendations', 'risk explanations', 'remediation steps'],
  },
  {
    id: 'doc-009',
    category: 'documentation',
    title: 'Password Reset Self-Service Guide',
    situation: 'A client has enabled self-service password reset (SSPR) in Entra ID. You need to create an end-user guide explaining how employees can reset their own passwords when locked out, including registration and the actual reset process.',
    difficulty: 1,
    idealElements: ['non-technical language', 'screenshots described', 'step-by-step', 'common issues', 'when to contact support'],
  },
  {
    id: 'doc-010',
    category: 'documentation',
    title: 'Firewall Change Request Template',
    situation: 'Your team needs a standardized template for firewall change requests that captures all necessary information: source, destination, ports, protocol, business justification, requestor, approver, and implementation date. This will be used across multiple clients.',
    difficulty: 1,
    idealElements: ['all required fields', 'clear format', 'approval workflow', 'rollback plan section', 'implementation notes'],
  },
  {
    id: 'doc-011',
    category: 'documentation',
    title: 'Disaster Recovery Plan Section',
    situation: 'You need to write the "Communication Plan" section of a client\'s disaster recovery plan. This should cover who gets notified during different types of incidents, contact methods, escalation paths, and templates for status updates.',
    difficulty: 3,
    idealElements: ['contact hierarchy', 'escalation criteria', 'communication methods', 'update frequency', 'template examples'],
  },
  {
    id: 'doc-012',
    category: 'documentation',
    title: 'Offboarding Procedure',
    situation: 'An employee is leaving a client company under difficult circumstances (termination). You need to document the immediate actions required: disable account, revoke sessions, block sign-in, forward email, transfer OneDrive, remove from groups, and preserve mailbox for legal hold.',
    roleHint: 'Termination procedures need to be fast and thorough.',
    difficulty: 2,
    idealElements: ['priority-ordered steps', 'timing considerations', 'legal/compliance notes', 'verification steps', 'documentation requirements'],
  },

  // ========== RESEARCH (12 scenarios) ==========
  {
    id: 'res-001',
    category: 'research',
    title: 'Conditional Access Deep Dive',
    situation: 'You\'ve been assigned a ticket that involves a conditional access policy blocking a user, but you haven\'t worked with conditional access policies before. You need to understand what they are and how they work before you can troubleshoot.',
    roleHint: 'State your current knowledge level when learning something new.',
    difficulty: 1,
    idealElements: ['states current knowledge level', 'asks for practical explanation', 'requests real-world examples', 'specifies MSP/service desk context'],
  },
  {
    id: 'res-002',
    category: 'research',
    title: 'DMARC Implementation',
    situation: 'A client asked about implementing DMARC for their email domain. You know it\'s related to email authentication but aren\'t clear on how it works with SPF and DKIM, or what the implementation process involves. The client wants a recommendation by end of week.',
    difficulty: 2,
    idealElements: ['asks for relationship between SPF/DKIM/DMARC', 'implementation steps', 'common pitfalls', 'monitoring recommendations'],
  },
  {
    id: 'res-003',
    category: 'research',
    title: 'Windows Autopilot Overview',
    situation: 'Your company is considering using Windows Autopilot for device provisioning instead of traditional imaging. Your manager asked you to research what Autopilot is, what\'s required to implement it, and what the benefits and limitations are.',
    difficulty: 2,
    idealElements: ['asks for comparison with traditional imaging', 'prerequisites', 'benefits and limitations', 'implementation considerations'],
  },
  {
    id: 'res-004',
    category: 'research',
    title: 'Zero Trust Architecture',
    situation: 'A client\'s IT director mentioned wanting to move toward "zero trust" security. You\'ve heard the term but aren\'t sure what it means in practical terms or what changes it would require to their current setup (traditional on-prem AD with M365).',
    roleHint: 'Ask for practical implementation guidance, not just theory.',
    difficulty: 3,
    idealElements: ['asks for principles explanation', 'practical implementation steps', 'how it applies to their environment', 'where to start'],
  },
  {
    id: 'res-005',
    category: 'research',
    title: 'Microsoft Defender for Endpoint',
    situation: 'Your company is evaluating Microsoft Defender for Endpoint as a replacement for the current third-party antivirus. You need to understand what it includes, how it differs from standard Windows Defender, and what licensing is required.',
    difficulty: 1,
    idealElements: ['feature comparison', 'licensing requirements', 'deployment considerations', 'management interface'],
  },
  {
    id: 'res-006',
    category: 'research',
    title: 'Azure AD B2B vs B2C',
    situation: 'A client wants to give external partners access to a SharePoint site and also wants to build a customer portal. Someone mentioned Azure AD B2B and B2C as options. You need to understand the difference and which applies to each scenario.',
    difficulty: 2,
    idealElements: ['clear distinction between B2B and B2C', 'use case mapping', 'implementation differences', 'licensing considerations'],
  },
  {
    id: 'res-007',
    category: 'research',
    title: 'PowerShell for Exchange Online',
    situation: 'You\'ve been using the Exchange admin center GUI but need to start using PowerShell for bulk operations. You\'re comfortable with basic PowerShell but haven\'t connected to Exchange Online before or used Exchange-specific cmdlets.',
    roleHint: 'Be specific about your current skill level.',
    difficulty: 1,
    idealElements: ['connection methods', 'common cmdlets for MSP tasks', 'practical examples', 'error handling tips'],
  },
  {
    id: 'res-008',
    category: 'research',
    title: 'Intune App Protection Policies',
    situation: 'A client wants to allow employees to access company email on personal phones but is worried about data leakage. Someone mentioned Intune App Protection Policies as a solution. You need to understand what they do and how they\'re different from device enrollment.',
    difficulty: 2,
    idealElements: ['explains MAM vs MDM', 'what APP can control', 'deployment scenarios', 'user experience impact'],
  },
  {
    id: 'res-009',
    category: 'research',
    title: 'Microsoft Graph API Basics',
    situation: 'You want to start automating some M365 tasks using the Microsoft Graph API but have no experience with APIs. You need a beginner-friendly explanation of what Graph is, how to authenticate, and how to make basic calls.',
    roleHint: 'Indicate you\'re new to APIs in general.',
    difficulty: 2,
    idealElements: ['explains API concepts simply', 'authentication methods', 'first steps to try', 'practical examples'],
  },
  {
    id: 'res-010',
    category: 'research',
    title: 'Hybrid Azure AD Join',
    situation: 'A client with on-premises Active Directory wants to understand what Hybrid Azure AD Join is and whether they should implement it. They currently have Azure AD Connect for identity sync but devices are only domain-joined, not Azure AD joined.',
    difficulty: 3,
    idealElements: ['explains hybrid join concept', 'benefits for their scenario', 'prerequisites', 'implementation approach'],
  },
  {
    id: 'res-011',
    category: 'research',
    title: 'Email Retention Policies',
    situation: 'A client in a regulated industry (healthcare) asked about email retention requirements. You need to understand the difference between Microsoft 365 retention policies, litigation hold, and archive mailboxes, and how they might apply to compliance requirements.',
    difficulty: 2,
    idealElements: ['explains each retention option', 'compliance scenarios', 'how they interact', 'implementation recommendations'],
  },
  {
    id: 'res-012',
    category: 'research',
    title: 'Passkeys and Passwordless Authentication',
    situation: 'Your company\'s security team is talking about moving to "passwordless" authentication using passkeys. You\'ve seen passkeys mentioned in Windows and Microsoft 365 but don\'t understand how they work or what\'s needed to implement them.',
    roleHint: 'Ask for both the technical explanation and practical implementation path.',
    difficulty: 2,
    idealElements: ['explains passkey technology', 'Microsoft implementation options', 'prerequisites', 'migration path from passwords'],
  },
];
